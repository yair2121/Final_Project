{"ast":null,"code":"// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n'use strict';var ERR_STREAM_PREMATURE_CLOSE=require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;function once(callback){var called=false;return function(){if(called)return;called=true;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}callback.apply(this,args);};}function noop(){}function isRequest(stream){return stream.setHeader&&typeof stream.abort==='function';}function eos(stream,opts,callback){if(typeof opts==='function')return eos(stream,null,opts);if(!opts)opts={};callback=once(callback||noop);var readable=opts.readable||opts.readable!==false&&stream.readable;var writable=opts.writable||opts.writable!==false&&stream.writable;var onlegacyfinish=function onlegacyfinish(){if(!stream.writable)onfinish();};var writableEnded=stream._writableState&&stream._writableState.finished;var onfinish=function onfinish(){writable=false;writableEnded=true;if(!readable)callback.call(stream);};var readableEnded=stream._readableState&&stream._readableState.endEmitted;var onend=function onend(){readable=false;readableEnded=true;if(!writable)callback.call(stream);};var onerror=function onerror(err){callback.call(stream,err);};var onclose=function onclose(){var err;if(readable&&!readableEnded){if(!stream._readableState||!stream._readableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE();return callback.call(stream,err);}if(writable&&!writableEnded){if(!stream._writableState||!stream._writableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE();return callback.call(stream,err);}};var onrequest=function onrequest(){stream.req.on('finish',onfinish);};if(isRequest(stream)){stream.on('complete',onfinish);stream.on('abort',onclose);if(stream.req)onrequest();else stream.on('request',onrequest);}else if(writable&&!stream._writableState){// legacy streams\nstream.on('end',onlegacyfinish);stream.on('close',onlegacyfinish);}stream.on('end',onend);stream.on('finish',onfinish);if(opts.error!==false)stream.on('error',onerror);stream.on('close',onclose);return function(){stream.removeListener('complete',onfinish);stream.removeListener('abort',onclose);stream.removeListener('request',onrequest);if(stream.req)stream.req.removeListener('finish',onfinish);stream.removeListener('end',onlegacyfinish);stream.removeListener('close',onlegacyfinish);stream.removeListener('finish',onfinish);stream.removeListener('end',onend);stream.removeListener('error',onerror);stream.removeListener('close',onclose);};}module.exports=eos;","map":{"version":3,"names":["ERR_STREAM_PREMATURE_CLOSE","require","codes","once","callback","called","_len","arguments","length","args","Array","_key","apply","noop","isRequest","stream","setHeader","abort","eos","opts","readable","writable","onlegacyfinish","onfinish","writableEnded","_writableState","finished","call","readableEnded","_readableState","endEmitted","onend","onerror","err","onclose","ended","onrequest","req","on","error","removeListener","module","exports"],"sources":["/usr/local/lib/node_modules/expo-cli/node_modules/hash-base/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"],"sourcesContent":["// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n'use strict';\n\nvar ERR_STREAM_PREMATURE_CLOSE = require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;\n\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    callback.apply(this, args);\n  };\n}\n\nfunction noop() {}\n\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\n\nfunction eos(stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n\n  var onlegacyfinish = function onlegacyfinish() {\n    if (!stream.writable) onfinish();\n  };\n\n  var writableEnded = stream._writableState && stream._writableState.finished;\n\n  var onfinish = function onfinish() {\n    writable = false;\n    writableEnded = true;\n    if (!readable) callback.call(stream);\n  };\n\n  var readableEnded = stream._readableState && stream._readableState.endEmitted;\n\n  var onend = function onend() {\n    readable = false;\n    readableEnded = true;\n    if (!writable) callback.call(stream);\n  };\n\n  var onerror = function onerror(err) {\n    callback.call(stream, err);\n  };\n\n  var onclose = function onclose() {\n    var err;\n\n    if (readable && !readableEnded) {\n      if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n\n    if (writable && !writableEnded) {\n      if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n  };\n\n  var onrequest = function onrequest() {\n    stream.req.on('finish', onfinish);\n  };\n\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !stream._writableState) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n}\n\nmodule.exports = eos;"],"mappings":"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"},"metadata":{},"sourceType":"script"}