{"ast":null,"code":"'use strict';var assert=require('minimalistic-assert');var inherits=require('inherits');var utils=require('./utils');var Cipher=require('./cipher');function DESState(){this.tmp=new Array(2);this.keys=null;}function DES(options){Cipher.call(this,options);var state=new DESState();this._desState=state;this.deriveKeys(state,options.key);}inherits(DES,Cipher);module.exports=DES;DES.create=function create(options){return new DES(options);};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function deriveKeys(state,key){state.keys=new Array(16*2);assert.equal(key.length,this.blockSize,'Invalid key length');var kL=utils.readUInt32BE(key,0);var kR=utils.readUInt32BE(key,4);utils.pc1(kL,kR,state.tmp,0);kL=state.tmp[0];kR=state.tmp[1];for(var i=0;i<state.keys.length;i+=2){var shift=shiftTable[i>>>1];kL=utils.r28shl(kL,shift);kR=utils.r28shl(kR,shift);utils.pc2(kL,kR,state.keys,i);}};DES.prototype._update=function _update(inp,inOff,out,outOff){var state=this._desState;var l=utils.readUInt32BE(inp,inOff);var r=utils.readUInt32BE(inp,inOff+4);// Initial Permutation\nutils.ip(l,r,state.tmp,0);l=state.tmp[0];r=state.tmp[1];if(this.type==='encrypt')this._encrypt(state,l,r,state.tmp,0);else this._decrypt(state,l,r,state.tmp,0);l=state.tmp[0];r=state.tmp[1];utils.writeUInt32BE(out,l,outOff);utils.writeUInt32BE(out,r,outOff+4);};DES.prototype._pad=function _pad(buffer,off){var value=buffer.length-off;for(var i=off;i<buffer.length;i++)buffer[i]=value;return true;};DES.prototype._unpad=function _unpad(buffer){var pad=buffer[buffer.length-1];for(var i=buffer.length-pad;i<buffer.length;i++)assert.equal(buffer[i],pad);return buffer.slice(0,buffer.length-pad);};DES.prototype._encrypt=function _encrypt(state,lStart,rStart,out,off){var l=lStart;var r=rStart;// Apply f() x16 times\nfor(var i=0;i<state.keys.length;i+=2){var keyL=state.keys[i];var keyR=state.keys[i+1];// f(r, k)\nutils.expand(r,state.tmp,0);keyL^=state.tmp[0];keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR);var f=utils.permute(s);var t=r;r=(l^f)>>>0;l=t;}// Reverse Initial Permutation\nutils.rip(r,l,out,off);};DES.prototype._decrypt=function _decrypt(state,lStart,rStart,out,off){var l=rStart;var r=lStart;// Apply f() x16 times\nfor(var i=state.keys.length-2;i>=0;i-=2){var keyL=state.keys[i];var keyR=state.keys[i+1];// f(r, k)\nutils.expand(l,state.tmp,0);keyL^=state.tmp[0];keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR);var f=utils.permute(s);var t=l;l=(r^f)>>>0;r=t;}// Reverse Initial Permutation\nutils.rip(l,r,out,off);};","map":{"version":3,"names":["assert","require","inherits","utils","Cipher","DESState","tmp","Array","keys","DES","options","call","state","_desState","deriveKeys","key","module","exports","create","shiftTable","prototype","equal","length","blockSize","kL","readUInt32BE","kR","pc1","i","shift","r28shl","pc2","_update","inp","inOff","out","outOff","l","r","ip","type","_encrypt","_decrypt","writeUInt32BE","_pad","buffer","off","value","_unpad","pad","slice","lStart","rStart","keyL","keyR","expand","s","substitute","f","permute","t","rip"],"sources":["/usr/local/lib/node_modules/expo-cli/node_modules/des.js/lib/des/des.js"],"sourcesContent":["'use strict';\n\nvar assert = require('minimalistic-assert');\nvar inherits = require('inherits');\n\nvar utils = require('./utils');\nvar Cipher = require('./cipher');\n\nfunction DESState() {\n  this.tmp = new Array(2);\n  this.keys = null;\n}\n\nfunction DES(options) {\n  Cipher.call(this, options);\n\n  var state = new DESState();\n  this._desState = state;\n\n  this.deriveKeys(state, options.key);\n}\ninherits(DES, Cipher);\nmodule.exports = DES;\n\nDES.create = function create(options) {\n  return new DES(options);\n};\n\nvar shiftTable = [\n  1, 1, 2, 2, 2, 2, 2, 2,\n  1, 2, 2, 2, 2, 2, 2, 1\n];\n\nDES.prototype.deriveKeys = function deriveKeys(state, key) {\n  state.keys = new Array(16 * 2);\n\n  assert.equal(key.length, this.blockSize, 'Invalid key length');\n\n  var kL = utils.readUInt32BE(key, 0);\n  var kR = utils.readUInt32BE(key, 4);\n\n  utils.pc1(kL, kR, state.tmp, 0);\n  kL = state.tmp[0];\n  kR = state.tmp[1];\n  for (var i = 0; i < state.keys.length; i += 2) {\n    var shift = shiftTable[i >>> 1];\n    kL = utils.r28shl(kL, shift);\n    kR = utils.r28shl(kR, shift);\n    utils.pc2(kL, kR, state.keys, i);\n  }\n};\n\nDES.prototype._update = function _update(inp, inOff, out, outOff) {\n  var state = this._desState;\n\n  var l = utils.readUInt32BE(inp, inOff);\n  var r = utils.readUInt32BE(inp, inOff + 4);\n\n  // Initial Permutation\n  utils.ip(l, r, state.tmp, 0);\n  l = state.tmp[0];\n  r = state.tmp[1];\n\n  if (this.type === 'encrypt')\n    this._encrypt(state, l, r, state.tmp, 0);\n  else\n    this._decrypt(state, l, r, state.tmp, 0);\n\n  l = state.tmp[0];\n  r = state.tmp[1];\n\n  utils.writeUInt32BE(out, l, outOff);\n  utils.writeUInt32BE(out, r, outOff + 4);\n};\n\nDES.prototype._pad = function _pad(buffer, off) {\n  var value = buffer.length - off;\n  for (var i = off; i < buffer.length; i++)\n    buffer[i] = value;\n\n  return true;\n};\n\nDES.prototype._unpad = function _unpad(buffer) {\n  var pad = buffer[buffer.length - 1];\n  for (var i = buffer.length - pad; i < buffer.length; i++)\n    assert.equal(buffer[i], pad);\n\n  return buffer.slice(0, buffer.length - pad);\n};\n\nDES.prototype._encrypt = function _encrypt(state, lStart, rStart, out, off) {\n  var l = lStart;\n  var r = rStart;\n\n  // Apply f() x16 times\n  for (var i = 0; i < state.keys.length; i += 2) {\n    var keyL = state.keys[i];\n    var keyR = state.keys[i + 1];\n\n    // f(r, k)\n    utils.expand(r, state.tmp, 0);\n\n    keyL ^= state.tmp[0];\n    keyR ^= state.tmp[1];\n    var s = utils.substitute(keyL, keyR);\n    var f = utils.permute(s);\n\n    var t = r;\n    r = (l ^ f) >>> 0;\n    l = t;\n  }\n\n  // Reverse Initial Permutation\n  utils.rip(r, l, out, off);\n};\n\nDES.prototype._decrypt = function _decrypt(state, lStart, rStart, out, off) {\n  var l = rStart;\n  var r = lStart;\n\n  // Apply f() x16 times\n  for (var i = state.keys.length - 2; i >= 0; i -= 2) {\n    var keyL = state.keys[i];\n    var keyR = state.keys[i + 1];\n\n    // f(r, k)\n    utils.expand(l, state.tmp, 0);\n\n    keyL ^= state.tmp[0];\n    keyR ^= state.tmp[1];\n    var s = utils.substitute(keyL, keyR);\n    var f = utils.permute(s);\n\n    var t = l;\n    l = (r ^ f) >>> 0;\n    r = t;\n  }\n\n  // Reverse Initial Permutation\n  utils.rip(l, r, out, off);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}