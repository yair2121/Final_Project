{"ast":null,"code":"'use strict';var BN=require('bn.js');var HmacDRBG=require('hmac-drbg');var utils=require('../utils');var curves=require('../curves');var rand=require('brorand');var assert=utils.assert;var KeyPair=require('./key');var Signature=require('./signature');function EC(options){if(!(this instanceof EC))return new EC(options);// Shortcut `elliptic.ec(curve-name)`\nif(typeof options==='string'){assert(Object.prototype.hasOwnProperty.call(curves,options),'Unknown curve '+options);options=curves[options];}// Shortcut for `elliptic.ec(elliptic.curves.curveName)`\nif(options instanceof curves.PresetCurve)options={curve:options};this.curve=options.curve.curve;this.n=this.curve.n;this.nh=this.n.ushrn(1);this.g=this.curve.g;// Point on curve\nthis.g=options.curve.g;this.g.precompute(options.curve.n.bitLength()+1);// Hash for function for DRBG\nthis.hash=options.hash||options.curve.hash;}module.exports=EC;EC.prototype.keyPair=function keyPair(options){return new KeyPair(this,options);};EC.prototype.keyFromPrivate=function keyFromPrivate(priv,enc){return KeyPair.fromPrivate(this,priv,enc);};EC.prototype.keyFromPublic=function keyFromPublic(pub,enc){return KeyPair.fromPublic(this,pub,enc);};EC.prototype.genKeyPair=function genKeyPair(options){if(!options)options={};// Instantiate Hmac_DRBG\nvar drbg=new HmacDRBG({hash:this.hash,pers:options.pers,persEnc:options.persEnc||'utf8',entropy:options.entropy||rand(this.hash.hmacStrength),entropyEnc:options.entropy&&options.entropyEnc||'utf8',nonce:this.n.toArray()});var bytes=this.n.byteLength();var ns2=this.n.sub(new BN(2));for(;;){var priv=new BN(drbg.generate(bytes));if(priv.cmp(ns2)>0)continue;priv.iaddn(1);return this.keyFromPrivate(priv);}};EC.prototype._truncateToN=function _truncateToN(msg,truncOnly){var delta=msg.byteLength()*8-this.n.bitLength();if(delta>0)msg=msg.ushrn(delta);if(!truncOnly&&msg.cmp(this.n)>=0)return msg.sub(this.n);else return msg;};EC.prototype.sign=function sign(msg,key,enc,options){if(typeof enc==='object'){options=enc;enc=null;}if(!options)options={};key=this.keyFromPrivate(key,enc);msg=this._truncateToN(new BN(msg,16));// Zero-extend key to provide enough entropy\nvar bytes=this.n.byteLength();var bkey=key.getPrivate().toArray('be',bytes);// Zero-extend nonce to have the same byte size as N\nvar nonce=msg.toArray('be',bytes);// Instantiate Hmac_DRBG\nvar drbg=new HmacDRBG({hash:this.hash,entropy:bkey,nonce:nonce,pers:options.pers,persEnc:options.persEnc||'utf8'});// Number of bytes to generate\nvar ns1=this.n.sub(new BN(1));for(var iter=0;;iter++){var k=options.k?options.k(iter):new BN(drbg.generate(this.n.byteLength()));k=this._truncateToN(k,true);if(k.cmpn(1)<=0||k.cmp(ns1)>=0)continue;var kp=this.g.mul(k);if(kp.isInfinity())continue;var kpX=kp.getX();var r=kpX.umod(this.n);if(r.cmpn(0)===0)continue;var s=k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg));s=s.umod(this.n);if(s.cmpn(0)===0)continue;var recoveryParam=(kp.getY().isOdd()?1:0)|(kpX.cmp(r)!==0?2:0);// Use complement of `s`, if it is > `n / 2`\nif(options.canonical&&s.cmp(this.nh)>0){s=this.n.sub(s);recoveryParam^=1;}return new Signature({r:r,s:s,recoveryParam:recoveryParam});}};EC.prototype.verify=function verify(msg,signature,key,enc){msg=this._truncateToN(new BN(msg,16));key=this.keyFromPublic(key,enc);signature=new Signature(signature,'hex');// Perform primitive values validation\nvar r=signature.r;var s=signature.s;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return false;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return false;// Validate signature\nvar sinv=s.invm(this.n);var u1=sinv.mul(msg).umod(this.n);var u2=sinv.mul(r).umod(this.n);var p;if(!this.curve._maxwellTrick){p=this.g.mulAdd(u1,key.getPublic(),u2);if(p.isInfinity())return false;return p.getX().umod(this.n).cmp(r)===0;}// NOTE: Greg Maxwell's trick, inspired by:\n// https://git.io/vad3K\np=this.g.jmulAdd(u1,key.getPublic(),u2);if(p.isInfinity())return false;// Compare `p.x` of Jacobian point with `r`,\n// this will do `p.x == r * p.z^2` instead of multiplying `p.x` by the\n// inverse of `p.z^2`\nreturn p.eqXToP(r);};EC.prototype.recoverPubKey=function(msg,signature,j,enc){assert((3&j)===j,'The recovery param is more than two bits');signature=new Signature(signature,enc);var n=this.n;var e=new BN(msg);var r=signature.r;var s=signature.s;// A set LSB signifies that the y-coordinate is odd\nvar isYOdd=j&1;var isSecondKey=j>>1;if(r.cmp(this.curve.p.umod(this.curve.n))>=0&&isSecondKey)throw new Error('Unable to find sencond key candinate');// 1.1. Let x = r + jn.\nif(isSecondKey)r=this.curve.pointFromX(r.add(this.curve.n),isYOdd);else r=this.curve.pointFromX(r,isYOdd);var rInv=signature.r.invm(n);var s1=n.sub(e).mul(rInv).umod(n);var s2=s.mul(rInv).umod(n);// 1.6.1 Compute Q = r^-1 (sR -  eG)\n//               Q = r^-1 (sR + -eG)\nreturn this.g.mulAdd(s1,r,s2);};EC.prototype.getKeyRecoveryParam=function(e,signature,Q,enc){signature=new Signature(signature,enc);if(signature.recoveryParam!==null)return signature.recoveryParam;for(var i=0;i<4;i++){var Qprime;try{Qprime=this.recoverPubKey(e,signature,i);}catch(e){continue;}if(Qprime.eq(Q))return i;}throw new Error('Unable to find valid recovery factor');};","map":{"version":3,"names":["BN","require","HmacDRBG","utils","curves","rand","assert","KeyPair","Signature","EC","options","Object","prototype","hasOwnProperty","call","PresetCurve","curve","n","nh","ushrn","g","precompute","bitLength","hash","module","exports","keyPair","keyFromPrivate","priv","enc","fromPrivate","keyFromPublic","pub","fromPublic","genKeyPair","drbg","pers","persEnc","entropy","hmacStrength","entropyEnc","nonce","toArray","bytes","byteLength","ns2","sub","generate","cmp","iaddn","_truncateToN","msg","truncOnly","delta","sign","key","bkey","getPrivate","ns1","iter","k","cmpn","kp","mul","isInfinity","kpX","getX","r","umod","s","invm","iadd","recoveryParam","getY","isOdd","canonical","verify","signature","sinv","u1","u2","p","_maxwellTrick","mulAdd","getPublic","jmulAdd","eqXToP","recoverPubKey","j","e","isYOdd","isSecondKey","Error","pointFromX","add","rInv","s1","s2","getKeyRecoveryParam","Q","i","Qprime","eq"],"sources":["/usr/local/lib/node_modules/expo-cli/node_modules/elliptic/lib/elliptic/ec/index.js"],"sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\nvar HmacDRBG = require('hmac-drbg');\nvar utils = require('../utils');\nvar curves = require('../curves');\nvar rand = require('brorand');\nvar assert = utils.assert;\n\nvar KeyPair = require('./key');\nvar Signature = require('./signature');\n\nfunction EC(options) {\n  if (!(this instanceof EC))\n    return new EC(options);\n\n  // Shortcut `elliptic.ec(curve-name)`\n  if (typeof options === 'string') {\n    assert(Object.prototype.hasOwnProperty.call(curves, options),\n      'Unknown curve ' + options);\n\n    options = curves[options];\n  }\n\n  // Shortcut for `elliptic.ec(elliptic.curves.curveName)`\n  if (options instanceof curves.PresetCurve)\n    options = { curve: options };\n\n  this.curve = options.curve.curve;\n  this.n = this.curve.n;\n  this.nh = this.n.ushrn(1);\n  this.g = this.curve.g;\n\n  // Point on curve\n  this.g = options.curve.g;\n  this.g.precompute(options.curve.n.bitLength() + 1);\n\n  // Hash for function for DRBG\n  this.hash = options.hash || options.curve.hash;\n}\nmodule.exports = EC;\n\nEC.prototype.keyPair = function keyPair(options) {\n  return new KeyPair(this, options);\n};\n\nEC.prototype.keyFromPrivate = function keyFromPrivate(priv, enc) {\n  return KeyPair.fromPrivate(this, priv, enc);\n};\n\nEC.prototype.keyFromPublic = function keyFromPublic(pub, enc) {\n  return KeyPair.fromPublic(this, pub, enc);\n};\n\nEC.prototype.genKeyPair = function genKeyPair(options) {\n  if (!options)\n    options = {};\n\n  // Instantiate Hmac_DRBG\n  var drbg = new HmacDRBG({\n    hash: this.hash,\n    pers: options.pers,\n    persEnc: options.persEnc || 'utf8',\n    entropy: options.entropy || rand(this.hash.hmacStrength),\n    entropyEnc: options.entropy && options.entropyEnc || 'utf8',\n    nonce: this.n.toArray(),\n  });\n\n  var bytes = this.n.byteLength();\n  var ns2 = this.n.sub(new BN(2));\n  for (;;) {\n    var priv = new BN(drbg.generate(bytes));\n    if (priv.cmp(ns2) > 0)\n      continue;\n\n    priv.iaddn(1);\n    return this.keyFromPrivate(priv);\n  }\n};\n\nEC.prototype._truncateToN = function _truncateToN(msg, truncOnly) {\n  var delta = msg.byteLength() * 8 - this.n.bitLength();\n  if (delta > 0)\n    msg = msg.ushrn(delta);\n  if (!truncOnly && msg.cmp(this.n) >= 0)\n    return msg.sub(this.n);\n  else\n    return msg;\n};\n\nEC.prototype.sign = function sign(msg, key, enc, options) {\n  if (typeof enc === 'object') {\n    options = enc;\n    enc = null;\n  }\n  if (!options)\n    options = {};\n\n  key = this.keyFromPrivate(key, enc);\n  msg = this._truncateToN(new BN(msg, 16));\n\n  // Zero-extend key to provide enough entropy\n  var bytes = this.n.byteLength();\n  var bkey = key.getPrivate().toArray('be', bytes);\n\n  // Zero-extend nonce to have the same byte size as N\n  var nonce = msg.toArray('be', bytes);\n\n  // Instantiate Hmac_DRBG\n  var drbg = new HmacDRBG({\n    hash: this.hash,\n    entropy: bkey,\n    nonce: nonce,\n    pers: options.pers,\n    persEnc: options.persEnc || 'utf8',\n  });\n\n  // Number of bytes to generate\n  var ns1 = this.n.sub(new BN(1));\n\n  for (var iter = 0; ; iter++) {\n    var k = options.k ?\n      options.k(iter) :\n      new BN(drbg.generate(this.n.byteLength()));\n    k = this._truncateToN(k, true);\n    if (k.cmpn(1) <= 0 || k.cmp(ns1) >= 0)\n      continue;\n\n    var kp = this.g.mul(k);\n    if (kp.isInfinity())\n      continue;\n\n    var kpX = kp.getX();\n    var r = kpX.umod(this.n);\n    if (r.cmpn(0) === 0)\n      continue;\n\n    var s = k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg));\n    s = s.umod(this.n);\n    if (s.cmpn(0) === 0)\n      continue;\n\n    var recoveryParam = (kp.getY().isOdd() ? 1 : 0) |\n                        (kpX.cmp(r) !== 0 ? 2 : 0);\n\n    // Use complement of `s`, if it is > `n / 2`\n    if (options.canonical && s.cmp(this.nh) > 0) {\n      s = this.n.sub(s);\n      recoveryParam ^= 1;\n    }\n\n    return new Signature({ r: r, s: s, recoveryParam: recoveryParam });\n  }\n};\n\nEC.prototype.verify = function verify(msg, signature, key, enc) {\n  msg = this._truncateToN(new BN(msg, 16));\n  key = this.keyFromPublic(key, enc);\n  signature = new Signature(signature, 'hex');\n\n  // Perform primitive values validation\n  var r = signature.r;\n  var s = signature.s;\n  if (r.cmpn(1) < 0 || r.cmp(this.n) >= 0)\n    return false;\n  if (s.cmpn(1) < 0 || s.cmp(this.n) >= 0)\n    return false;\n\n  // Validate signature\n  var sinv = s.invm(this.n);\n  var u1 = sinv.mul(msg).umod(this.n);\n  var u2 = sinv.mul(r).umod(this.n);\n  var p;\n\n  if (!this.curve._maxwellTrick) {\n    p = this.g.mulAdd(u1, key.getPublic(), u2);\n    if (p.isInfinity())\n      return false;\n\n    return p.getX().umod(this.n).cmp(r) === 0;\n  }\n\n  // NOTE: Greg Maxwell's trick, inspired by:\n  // https://git.io/vad3K\n\n  p = this.g.jmulAdd(u1, key.getPublic(), u2);\n  if (p.isInfinity())\n    return false;\n\n  // Compare `p.x` of Jacobian point with `r`,\n  // this will do `p.x == r * p.z^2` instead of multiplying `p.x` by the\n  // inverse of `p.z^2`\n  return p.eqXToP(r);\n};\n\nEC.prototype.recoverPubKey = function(msg, signature, j, enc) {\n  assert((3 & j) === j, 'The recovery param is more than two bits');\n  signature = new Signature(signature, enc);\n\n  var n = this.n;\n  var e = new BN(msg);\n  var r = signature.r;\n  var s = signature.s;\n\n  // A set LSB signifies that the y-coordinate is odd\n  var isYOdd = j & 1;\n  var isSecondKey = j >> 1;\n  if (r.cmp(this.curve.p.umod(this.curve.n)) >= 0 && isSecondKey)\n    throw new Error('Unable to find sencond key candinate');\n\n  // 1.1. Let x = r + jn.\n  if (isSecondKey)\n    r = this.curve.pointFromX(r.add(this.curve.n), isYOdd);\n  else\n    r = this.curve.pointFromX(r, isYOdd);\n\n  var rInv = signature.r.invm(n);\n  var s1 = n.sub(e).mul(rInv).umod(n);\n  var s2 = s.mul(rInv).umod(n);\n\n  // 1.6.1 Compute Q = r^-1 (sR -  eG)\n  //               Q = r^-1 (sR + -eG)\n  return this.g.mulAdd(s1, r, s2);\n};\n\nEC.prototype.getKeyRecoveryParam = function(e, signature, Q, enc) {\n  signature = new Signature(signature, enc);\n  if (signature.recoveryParam !== null)\n    return signature.recoveryParam;\n\n  for (var i = 0; i < 4; i++) {\n    var Qprime;\n    try {\n      Qprime = this.recoverPubKey(e, signature, i);\n    } catch (e) {\n      continue;\n    }\n\n    if (Qprime.eq(Q))\n      return i;\n  }\n  throw new Error('Unable to find valid recovery factor');\n};\n"],"mappings":"AAAA,aAEA,GAAIA,GAAE,CAAGC,OAAO,CAAC,OAAD,CAAhB,CACA,GAAIC,SAAQ,CAAGD,OAAO,CAAC,WAAD,CAAtB,CACA,GAAIE,MAAK,CAAGF,OAAO,CAAC,UAAD,CAAnB,CACA,GAAIG,OAAM,CAAGH,OAAO,CAAC,WAAD,CAApB,CACA,GAAII,KAAI,CAAGJ,OAAO,CAAC,SAAD,CAAlB,CACA,GAAIK,OAAM,CAAGH,KAAK,CAACG,MAAnB,CAEA,GAAIC,QAAO,CAAGN,OAAO,CAAC,OAAD,CAArB,CACA,GAAIO,UAAS,CAAGP,OAAO,CAAC,aAAD,CAAvB,CAEA,QAASQ,GAAT,CAAYC,OAAZ,CAAqB,CACnB,GAAI,EAAE,eAAgBD,GAAlB,CAAJ,CACE,MAAO,IAAIA,GAAJ,CAAOC,OAAP,CAAP,CAEF;AACA,GAAI,MAAOA,QAAP,GAAmB,QAAvB,CAAiC,CAC/BJ,MAAM,CAACK,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCV,MAArC,CAA6CM,OAA7C,CAAD,CACJ,iBAAmBA,OADf,CAAN,CAGAA,OAAO,CAAGN,MAAM,CAACM,OAAD,CAAhB,CACD,CAED;AACA,GAAIA,OAAO,WAAYN,OAAM,CAACW,WAA9B,CACEL,OAAO,CAAG,CAAEM,KAAK,CAAEN,OAAT,CAAV,CAEF,KAAKM,KAAL,CAAaN,OAAO,CAACM,KAAR,CAAcA,KAA3B,CACA,KAAKC,CAAL,CAAS,KAAKD,KAAL,CAAWC,CAApB,CACA,KAAKC,EAAL,CAAU,KAAKD,CAAL,CAAOE,KAAP,CAAa,CAAb,CAAV,CACA,KAAKC,CAAL,CAAS,KAAKJ,KAAL,CAAWI,CAApB,CAEA;AACA,KAAKA,CAAL,CAASV,OAAO,CAACM,KAAR,CAAcI,CAAvB,CACA,KAAKA,CAAL,CAAOC,UAAP,CAAkBX,OAAO,CAACM,KAAR,CAAcC,CAAd,CAAgBK,SAAhB,GAA8B,CAAhD,EAEA;AACA,KAAKC,IAAL,CAAYb,OAAO,CAACa,IAAR,EAAgBb,OAAO,CAACM,KAAR,CAAcO,IAA1C,CACD,CACDC,MAAM,CAACC,OAAP,CAAiBhB,EAAjB,CAEAA,EAAE,CAACG,SAAH,CAAac,OAAb,CAAuB,QAASA,QAAT,CAAiBhB,OAAjB,CAA0B,CAC/C,MAAO,IAAIH,QAAJ,CAAY,IAAZ,CAAkBG,OAAlB,CAAP,CACD,CAFD,CAIAD,EAAE,CAACG,SAAH,CAAae,cAAb,CAA8B,QAASA,eAAT,CAAwBC,IAAxB,CAA8BC,GAA9B,CAAmC,CAC/D,MAAOtB,QAAO,CAACuB,WAAR,CAAoB,IAApB,CAA0BF,IAA1B,CAAgCC,GAAhC,CAAP,CACD,CAFD,CAIApB,EAAE,CAACG,SAAH,CAAamB,aAAb,CAA6B,QAASA,cAAT,CAAuBC,GAAvB,CAA4BH,GAA5B,CAAiC,CAC5D,MAAOtB,QAAO,CAAC0B,UAAR,CAAmB,IAAnB,CAAyBD,GAAzB,CAA8BH,GAA9B,CAAP,CACD,CAFD,CAIApB,EAAE,CAACG,SAAH,CAAasB,UAAb,CAA0B,QAASA,WAAT,CAAoBxB,OAApB,CAA6B,CACrD,GAAI,CAACA,OAAL,CACEA,OAAO,CAAG,EAAV,CAEF;AACA,GAAIyB,KAAI,CAAG,GAAIjC,SAAJ,CAAa,CACtBqB,IAAI,CAAE,KAAKA,IADW,CAEtBa,IAAI,CAAE1B,OAAO,CAAC0B,IAFQ,CAGtBC,OAAO,CAAE3B,OAAO,CAAC2B,OAAR,EAAmB,MAHN,CAItBC,OAAO,CAAE5B,OAAO,CAAC4B,OAAR,EAAmBjC,IAAI,CAAC,KAAKkB,IAAL,CAAUgB,YAAX,CAJV,CAKtBC,UAAU,CAAE9B,OAAO,CAAC4B,OAAR,EAAmB5B,OAAO,CAAC8B,UAA3B,EAAyC,MAL/B,CAMtBC,KAAK,CAAE,KAAKxB,CAAL,CAAOyB,OAAP,EANe,CAAb,CAAX,CASA,GAAIC,MAAK,CAAG,KAAK1B,CAAL,CAAO2B,UAAP,EAAZ,CACA,GAAIC,IAAG,CAAG,KAAK5B,CAAL,CAAO6B,GAAP,CAAW,GAAI9C,GAAJ,CAAO,CAAP,CAAX,CAAV,CACA,OAAS,CACP,GAAI4B,KAAI,CAAG,GAAI5B,GAAJ,CAAOmC,IAAI,CAACY,QAAL,CAAcJ,KAAd,CAAP,CAAX,CACA,GAAIf,IAAI,CAACoB,GAAL,CAASH,GAAT,EAAgB,CAApB,CACE,SAEFjB,IAAI,CAACqB,KAAL,CAAW,CAAX,EACA,MAAO,MAAKtB,cAAL,CAAoBC,IAApB,CAAP,CACD,CACF,CAxBD,CA0BAnB,EAAE,CAACG,SAAH,CAAasC,YAAb,CAA4B,QAASA,aAAT,CAAsBC,GAAtB,CAA2BC,SAA3B,CAAsC,CAChE,GAAIC,MAAK,CAAGF,GAAG,CAACP,UAAJ,GAAmB,CAAnB,CAAuB,KAAK3B,CAAL,CAAOK,SAAP,EAAnC,CACA,GAAI+B,KAAK,CAAG,CAAZ,CACEF,GAAG,CAAGA,GAAG,CAAChC,KAAJ,CAAUkC,KAAV,CAAN,CACF,GAAI,CAACD,SAAD,EAAcD,GAAG,CAACH,GAAJ,CAAQ,KAAK/B,CAAb,GAAmB,CAArC,CACE,MAAOkC,IAAG,CAACL,GAAJ,CAAQ,KAAK7B,CAAb,CAAP,CADF,IAGE,OAAOkC,IAAP,CACH,CARD,CAUA1C,EAAE,CAACG,SAAH,CAAa0C,IAAb,CAAoB,QAASA,KAAT,CAAcH,GAAd,CAAmBI,GAAnB,CAAwB1B,GAAxB,CAA6BnB,OAA7B,CAAsC,CACxD,GAAI,MAAOmB,IAAP,GAAe,QAAnB,CAA6B,CAC3BnB,OAAO,CAAGmB,GAAV,CACAA,GAAG,CAAG,IAAN,CACD,CACD,GAAI,CAACnB,OAAL,CACEA,OAAO,CAAG,EAAV,CAEF6C,GAAG,CAAG,KAAK5B,cAAL,CAAoB4B,GAApB,CAAyB1B,GAAzB,CAAN,CACAsB,GAAG,CAAG,KAAKD,YAAL,CAAkB,GAAIlD,GAAJ,CAAOmD,GAAP,CAAY,EAAZ,CAAlB,CAAN,CAEA;AACA,GAAIR,MAAK,CAAG,KAAK1B,CAAL,CAAO2B,UAAP,EAAZ,CACA,GAAIY,KAAI,CAAGD,GAAG,CAACE,UAAJ,GAAiBf,OAAjB,CAAyB,IAAzB,CAA+BC,KAA/B,CAAX,CAEA;AACA,GAAIF,MAAK,CAAGU,GAAG,CAACT,OAAJ,CAAY,IAAZ,CAAkBC,KAAlB,CAAZ,CAEA;AACA,GAAIR,KAAI,CAAG,GAAIjC,SAAJ,CAAa,CACtBqB,IAAI,CAAE,KAAKA,IADW,CAEtBe,OAAO,CAAEkB,IAFa,CAGtBf,KAAK,CAAEA,KAHe,CAItBL,IAAI,CAAE1B,OAAO,CAAC0B,IAJQ,CAKtBC,OAAO,CAAE3B,OAAO,CAAC2B,OAAR,EAAmB,MALN,CAAb,CAAX,CAQA;AACA,GAAIqB,IAAG,CAAG,KAAKzC,CAAL,CAAO6B,GAAP,CAAW,GAAI9C,GAAJ,CAAO,CAAP,CAAX,CAAV,CAEA,IAAK,GAAI2D,KAAI,CAAG,CAAhB,EAAqBA,IAAI,EAAzB,CAA6B,CAC3B,GAAIC,EAAC,CAAGlD,OAAO,CAACkD,CAAR,CACNlD,OAAO,CAACkD,CAAR,CAAUD,IAAV,CADM,CAEN,GAAI3D,GAAJ,CAAOmC,IAAI,CAACY,QAAL,CAAc,KAAK9B,CAAL,CAAO2B,UAAP,EAAd,CAAP,CAFF,CAGAgB,CAAC,CAAG,KAAKV,YAAL,CAAkBU,CAAlB,CAAqB,IAArB,CAAJ,CACA,GAAIA,CAAC,CAACC,IAAF,CAAO,CAAP,GAAa,CAAb,EAAkBD,CAAC,CAACZ,GAAF,CAAMU,GAAN,GAAc,CAApC,CACE,SAEF,GAAII,GAAE,CAAG,KAAK1C,CAAL,CAAO2C,GAAP,CAAWH,CAAX,CAAT,CACA,GAAIE,EAAE,CAACE,UAAH,EAAJ,CACE,SAEF,GAAIC,IAAG,CAAGH,EAAE,CAACI,IAAH,EAAV,CACA,GAAIC,EAAC,CAAGF,GAAG,CAACG,IAAJ,CAAS,KAAKnD,CAAd,CAAR,CACA,GAAIkD,CAAC,CAACN,IAAF,CAAO,CAAP,IAAc,CAAlB,CACE,SAEF,GAAIQ,EAAC,CAAGT,CAAC,CAACU,IAAF,CAAO,KAAKrD,CAAZ,EAAe8C,GAAf,CAAmBI,CAAC,CAACJ,GAAF,CAAMR,GAAG,CAACE,UAAJ,EAAN,EAAwBc,IAAxB,CAA6BpB,GAA7B,CAAnB,CAAR,CACAkB,CAAC,CAAGA,CAAC,CAACD,IAAF,CAAO,KAAKnD,CAAZ,CAAJ,CACA,GAAIoD,CAAC,CAACR,IAAF,CAAO,CAAP,IAAc,CAAlB,CACE,SAEF,GAAIW,cAAa,CAAG,CAACV,EAAE,CAACW,IAAH,GAAUC,KAAV,GAAoB,CAApB,CAAwB,CAAzB,GACCT,GAAG,CAACjB,GAAJ,CAAQmB,CAAR,IAAe,CAAf,CAAmB,CAAnB,CAAuB,CADxB,CAApB,CAGA;AACA,GAAIzD,OAAO,CAACiE,SAAR,EAAqBN,CAAC,CAACrB,GAAF,CAAM,KAAK9B,EAAX,EAAiB,CAA1C,CAA6C,CAC3CmD,CAAC,CAAG,KAAKpD,CAAL,CAAO6B,GAAP,CAAWuB,CAAX,CAAJ,CACAG,aAAa,EAAI,CAAjB,CACD,CAED,MAAO,IAAIhE,UAAJ,CAAc,CAAE2D,CAAC,CAAEA,CAAL,CAAQE,CAAC,CAAEA,CAAX,CAAcG,aAAa,CAAEA,aAA7B,CAAd,CAAP,CACD,CACF,CA/DD,CAiEA/D,EAAE,CAACG,SAAH,CAAagE,MAAb,CAAsB,QAASA,OAAT,CAAgBzB,GAAhB,CAAqB0B,SAArB,CAAgCtB,GAAhC,CAAqC1B,GAArC,CAA0C,CAC9DsB,GAAG,CAAG,KAAKD,YAAL,CAAkB,GAAIlD,GAAJ,CAAOmD,GAAP,CAAY,EAAZ,CAAlB,CAAN,CACAI,GAAG,CAAG,KAAKxB,aAAL,CAAmBwB,GAAnB,CAAwB1B,GAAxB,CAAN,CACAgD,SAAS,CAAG,GAAIrE,UAAJ,CAAcqE,SAAd,CAAyB,KAAzB,CAAZ,CAEA;AACA,GAAIV,EAAC,CAAGU,SAAS,CAACV,CAAlB,CACA,GAAIE,EAAC,CAAGQ,SAAS,CAACR,CAAlB,CACA,GAAIF,CAAC,CAACN,IAAF,CAAO,CAAP,EAAY,CAAZ,EAAiBM,CAAC,CAACnB,GAAF,CAAM,KAAK/B,CAAX,GAAiB,CAAtC,CACE,MAAO,MAAP,CACF,GAAIoD,CAAC,CAACR,IAAF,CAAO,CAAP,EAAY,CAAZ,EAAiBQ,CAAC,CAACrB,GAAF,CAAM,KAAK/B,CAAX,GAAiB,CAAtC,CACE,MAAO,MAAP,CAEF;AACA,GAAI6D,KAAI,CAAGT,CAAC,CAACC,IAAF,CAAO,KAAKrD,CAAZ,CAAX,CACA,GAAI8D,GAAE,CAAGD,IAAI,CAACf,GAAL,CAASZ,GAAT,EAAciB,IAAd,CAAmB,KAAKnD,CAAxB,CAAT,CACA,GAAI+D,GAAE,CAAGF,IAAI,CAACf,GAAL,CAASI,CAAT,EAAYC,IAAZ,CAAiB,KAAKnD,CAAtB,CAAT,CACA,GAAIgE,EAAJ,CAEA,GAAI,CAAC,KAAKjE,KAAL,CAAWkE,aAAhB,CAA+B,CAC7BD,CAAC,CAAG,KAAK7D,CAAL,CAAO+D,MAAP,CAAcJ,EAAd,CAAkBxB,GAAG,CAAC6B,SAAJ,EAAlB,CAAmCJ,EAAnC,CAAJ,CACA,GAAIC,CAAC,CAACjB,UAAF,EAAJ,CACE,MAAO,MAAP,CAEF,MAAOiB,EAAC,CAACf,IAAF,GAASE,IAAT,CAAc,KAAKnD,CAAnB,EAAsB+B,GAAtB,CAA0BmB,CAA1B,IAAiC,CAAxC,CACD,CAED;AACA;AAEAc,CAAC,CAAG,KAAK7D,CAAL,CAAOiE,OAAP,CAAeN,EAAf,CAAmBxB,GAAG,CAAC6B,SAAJ,EAAnB,CAAoCJ,EAApC,CAAJ,CACA,GAAIC,CAAC,CAACjB,UAAF,EAAJ,CACE,MAAO,MAAP,CAEF;AACA;AACA;AACA,MAAOiB,EAAC,CAACK,MAAF,CAASnB,CAAT,CAAP,CACD,CAtCD,CAwCA1D,EAAE,CAACG,SAAH,CAAa2E,aAAb,CAA6B,SAASpC,GAAT,CAAc0B,SAAd,CAAyBW,CAAzB,CAA4B3D,GAA5B,CAAiC,CAC5DvB,MAAM,CAAC,CAAC,EAAIkF,CAAL,IAAYA,CAAb,CAAgB,0CAAhB,CAAN,CACAX,SAAS,CAAG,GAAIrE,UAAJ,CAAcqE,SAAd,CAAyBhD,GAAzB,CAAZ,CAEA,GAAIZ,EAAC,CAAG,KAAKA,CAAb,CACA,GAAIwE,EAAC,CAAG,GAAIzF,GAAJ,CAAOmD,GAAP,CAAR,CACA,GAAIgB,EAAC,CAAGU,SAAS,CAACV,CAAlB,CACA,GAAIE,EAAC,CAAGQ,SAAS,CAACR,CAAlB,CAEA;AACA,GAAIqB,OAAM,CAAGF,CAAC,CAAG,CAAjB,CACA,GAAIG,YAAW,CAAGH,CAAC,EAAI,CAAvB,CACA,GAAIrB,CAAC,CAACnB,GAAF,CAAM,KAAKhC,KAAL,CAAWiE,CAAX,CAAab,IAAb,CAAkB,KAAKpD,KAAL,CAAWC,CAA7B,CAAN,GAA0C,CAA1C,EAA+C0E,WAAnD,CACE,KAAM,IAAIC,MAAJ,CAAU,sCAAV,CAAN,CAEF;AACA,GAAID,WAAJ,CACExB,CAAC,CAAG,KAAKnD,KAAL,CAAW6E,UAAX,CAAsB1B,CAAC,CAAC2B,GAAF,CAAM,KAAK9E,KAAL,CAAWC,CAAjB,CAAtB,CAA2CyE,MAA3C,CAAJ,CADF,IAGEvB,EAAC,CAAG,KAAKnD,KAAL,CAAW6E,UAAX,CAAsB1B,CAAtB,CAAyBuB,MAAzB,CAAJ,CAEF,GAAIK,KAAI,CAAGlB,SAAS,CAACV,CAAV,CAAYG,IAAZ,CAAiBrD,CAAjB,CAAX,CACA,GAAI+E,GAAE,CAAG/E,CAAC,CAAC6B,GAAF,CAAM2C,CAAN,EAAS1B,GAAT,CAAagC,IAAb,EAAmB3B,IAAnB,CAAwBnD,CAAxB,CAAT,CACA,GAAIgF,GAAE,CAAG5B,CAAC,CAACN,GAAF,CAAMgC,IAAN,EAAY3B,IAAZ,CAAiBnD,CAAjB,CAAT,CAEA;AACA;AACA,MAAO,MAAKG,CAAL,CAAO+D,MAAP,CAAca,EAAd,CAAkB7B,CAAlB,CAAqB8B,EAArB,CAAP,CACD,CA5BD,CA8BAxF,EAAE,CAACG,SAAH,CAAasF,mBAAb,CAAmC,SAAST,CAAT,CAAYZ,SAAZ,CAAuBsB,CAAvB,CAA0BtE,GAA1B,CAA+B,CAChEgD,SAAS,CAAG,GAAIrE,UAAJ,CAAcqE,SAAd,CAAyBhD,GAAzB,CAAZ,CACA,GAAIgD,SAAS,CAACL,aAAV,GAA4B,IAAhC,CACE,MAAOK,UAAS,CAACL,aAAjB,CAEF,IAAK,GAAI4B,EAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,CAApB,CAAuBA,CAAC,EAAxB,CAA4B,CAC1B,GAAIC,OAAJ,CACA,GAAI,CACFA,MAAM,CAAG,KAAKd,aAAL,CAAmBE,CAAnB,CAAsBZ,SAAtB,CAAiCuB,CAAjC,CAAT,CACD,CAAC,MAAOX,CAAP,CAAU,CACV,SACD,CAED,GAAIY,MAAM,CAACC,EAAP,CAAUH,CAAV,CAAJ,CACE,MAAOC,EAAP,CACH,CACD,KAAM,IAAIR,MAAJ,CAAU,sCAAV,CAAN,CACD,CAjBD"},"metadata":{},"sourceType":"script"}